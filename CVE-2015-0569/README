Jan 25 2016*
-------------------------
Thanks to Nico Golde's info about this issue was assigned a CVE( CVE-2015-0569) a few months ago:
http://www.openwall.com/lists/oss-security/2016/01/24/9

***Summary***

One exploitable bug has been fixed in prima wlan driver a few months
ago.

Upstream fix:
https://www.codeaurora.org/cgit/quic/la//platform/vendor/qcom-opensource/wlan/qcacld-2.0/commit/?id=a079d716b5481223f0166c644e9ec7c75a31b02c

https://github.com/sonyxperiadev/prima/commit/4b91219ada9e73c897da2e0ae7bf2ff043dde950

Cyanogenmod's backport fix:
https://github.com/CyanogenMod/android_kernel_sony_msm8960t/commit/d58f1eacbdf55946ec7062ab6e4df462bf30ef32

It was lacking a check for valid length of copy a buffer, which can be
crafted by userspace. The application could communicate with wlan
driver via ioctl() with 0x8bf7 to enter into vulnerable code path.

This issue may leads to a local DoS or privilege escalation. Some
android phone/tablet are still using the vulnerable version of prima
driver. We've aware of android-msm-flo-3.4-marshmallow for Nexus 7(
2013) is affected by this isuee:

https://android.googlesource.com/kernel/msm/+/android-msm-flo-3.4-marshmallow

Plz review the file:

msm-kernel/drivers/staging/prima/CORE/HDD/src/wlan_hdd_wext.c


Then we've already sent a patch to backport fix for the branch and
still doesn't get any answer yet:

https://android.googlesource.com/kernel/msm/+/15c8afebed947b30370095cbb7de6257891a3971%5E!/#F0

PoC:

https://raw.githubusercontent.com/hardenedlinux/offensive_poc/master/CVE-2015-0569/cve-2015-0569.c


Mitigation:

We haven't exmine if this issue can be exploited to gain the root
privileges. But some fancy mitigation like PXN is not support well for
android armv7. Porting PaX UDEREF is an another option.


Co-worker: citypw, pray3r
